name: Fetch Fast8888 Subscribe

on:
  workflow_dispatch:  # 手动触发
  schedule:          # 定时触发，每天凌晨 0 点
    - cron: '0 0 * * *'

jobs:
  fetch:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repo
      uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: "18"

    - name: Install Dependencies
      run: npm install node-fetch

- name: Run Script
  run: node fast8888.js

- name: Check file
  run: ls -la subscribe.txt

- name: Commit subscribe.txt
  run: |
    git config user.name "github-actions"
    git config user.email "github-actions@users.noreply.github.com"
    git add subscribe.txt
    git commit -m "更新订阅链接 $(date +'%Y-%m-%d %H:%M:%S')" || echo "No changes"
    git push
        git push
